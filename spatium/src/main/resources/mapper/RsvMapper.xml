<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.urban.spatium.mapper.RsvMapper">

	<insert id="insertRsvItemDetail" parameterType="Rsv">
		INSERT INTO tbRsvDetail
			(rsvDetailItem
			, rsvDetailNum
			, rsvDetailOnePrice
			, rsvDetailTotalPrice)
		VALUES 
		<foreach collection="itemList" item="i" separator=",">		
			(#{i.itemCode}
			, #{i.itemCount}
			, #{i.itemRentalPrice}
			, #{i.itemTotalPrice})
		</foreach>
	</insert>
		
	<insert id="insertRsvSpaceDetail" parameterType="Rsv">
		INSERT INTO tbRsvDetail
			(rsvDetailSpace
			, rsvDetailOnePrice
			, rsvDetailTotalPrice)
		VALUES 
		<foreach collection="spaceList" item="s" separator=",">		
			(#{s.spaceCode}
			, #{s.spaceRentalPrice}
			, #{s.spaceRentalPrice})
		</foreach>
	</insert>	
		
	<select id="getItemByCode" parameterType="int" resultType="Item">
		SELECT 
			  itemCode
			, storeTotalCode
			, itemTotalName
			, itemTotalAmount
			, itemRentalAmount
			, itemRentalPrice
			, itemRentalDeposit
			, itemImg
			, itemRegDate
			, itemChangeRegDate
			, itemTotalUserId
		FROM 
			tbItemTotalAmount
		WHERE
			itemCode = #{tbRecord}
	</select>
		
	<select id="getSpaceByCode" parameterType="int" resultType="OKSpace">
		SELECT 
			okaySpaceCode
			, okayStoreCode
			, okaySpaceName
			, okaySpaceType
			, okayPeopleNumber
			, okayDetailSpace
			, okayBriefSpace
			, okaySpaceTag
			, okaySpaceRentalPrice
			, okayStartTime
			, okayCloseTime
			, okaySpaceRsvType
			, okayExceptionStartDate
			, okayExceptionEndDate
			, okayCompletedDate
			, okaySpaceBasicOption
			, okaySpaceId
			, okayRefundPolicyCode
		FROM 
			tbOkaySpace
		WHERE
			okaySpaceCode = #{tbRecord}
	</select>
	
	<select id="getItemByStore" resultType="Item">
		SELECT 
			  itemCode
			, storeTotalCode
			, itemTotalName
			, itemTotalAmount
			, itemRentalAmount
			, itemRentalPrice
			, itemRentalDeposit
			, itemImg
			, itemRegDate
			, itemChangeRegDate
			, itemTotalUserId
		FROM 
			tbItemTotalAmount
	</select>
		
	<select id="getSpaceByStore" resultType="OKSpace">
		SELECT 
			  okaySpaceCode
			, okayStoreCode
			, okaySpaceName
			, okaySpaceType
			, okayPeopleNumber
			, okayDetailSpace
			, okayBriefSpace
			, okaySpaceTag
			, okaySpaceRentalPrice
			, okayStartTime
			, okayCloseTime
			, okaySpaceRsvType
			, okayExceptionStartDate
			, okayExceptionEndDate
			, okayCompletedDate
			, okaySpaceBasicOption
			, okaySpaceId
			, okayRefundPolicyCode
			, spaceCateName
		FROM 
			tbOkaySpace AS s
		INNER JOIN
			tbSpaceCate AS c
		ON
			s.okaySpaceType = c.spaceCateCode
	</select>
	
	<select id="rsvDetailList" resultType="Rsv">
		SELECT 
			rsvDetailCode
			, rsvDetailSpace
			, rsvDetailSeat
			, rsvDetailItem
			, rsvDetailNum
			, rsvDetailOnePrice
			, rsvDetailTotalPrice
		FROM 
			tbRsvDetail
	</select>
		
	<select id="rsvList" resultType="Rsv">
		SELECT 
			  rsvCode
			, rsvUserId
			, rsvUserName
			, rsvUserPhone
			, rsvUserEmail
			, rsvUserRequest
			, rsvTotalPrice
			, rsvStartDateTime
			, rsvEndDateTime
			, rsvRegDate
			, rsvState
		FROM 
			tbRsv
	</select>
	
	<insert id="insertTbRsv" parameterType="Rsv">
		INSERT INTO tbRsv(
			  rsvUserId
			, rsvUserName
			, rsvUserPhone
			, rsvUserEmail
			, rsvUserRequest
			, rsvTotalPrice
			, rsvStartDateTime
			, rsvEndDateTime
			, rsvRegDate
		)VALUES(
			  #{rsvUserId}
			, #{rsvUserName}
			, #{rsvUserPhone}
			, #{rsvUserEmail}
			, #{rsvUserRequest}
			, #{rsvTotalPrice}
			, #{rsvStartDateTime}
			, #{rsvEndDateTime}
			, NOW()
		);
	</insert>
	
	
</mapper>